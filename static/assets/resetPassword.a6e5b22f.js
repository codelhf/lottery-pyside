import{_ as D,d as N,u as K,h as g,l as $,r as w,o as l,c as V,a as m,p as i,w as s,b as n,v as c,q as k,t as z,x as B,H as E,E as p,I as F,J as q,e as _,B as A,C as H}from"./index.e7cb72d6.js";import{i as T,a as J,b as M}from"./validate.32e385d1.js";import{s as j}from"./valid-code.9c0a10ca.js";const G=N({name:"ResetPassword",setup(){const e=K(),r=g(1),o=$({loading:!1,phone:"",validSmsCode:"",newPassword:"",confirmPassword:""}),C=g(!1),f=g(300),R=()=>{E({phone:o.phone})},d=g("password"),t=()=>{d.value===""?d.value="password":d.value=""},u=g("password"),v=()=>{u.value===""?u.value="password":u.value=""},h=()=>o.phone?J(o.phone)?!0:(p.warning({message:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u5148\u8F93\u5165\u624B\u673A\u53F7",type:"warning"}),!1),P=()=>!o.validSmsCode||!M(o.validSmsCode)?(p.warning({message:"\u8BF7\u8F93\u51656\u4F4D\u6570\u5B57\u9A8C\u8BC1\u7801",type:"warning"}),!1):!0;let a=null;const b=()=>{if(!h()){console.log("1");return}console.log("2"),j(o).then(y=>{C.value=!0,a&&clearInterval(a),a=setInterval(()=>{f.value=f.value-1,f.value===0&&(C.value=!1,clearInterval(a))},1e3)})},S=()=>o.newPassword?T(o.newPassword)?!0:(p.warning({message:"\u65B0\u5BC6\u7801\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",type:"warning"}),!1),I=()=>o.confirmPassword?T(o.confirmPassword)?o.confirmPassword!==o.newPassword?(p.warning({message:"\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4",type:"warning"}),!1):!0:(p.warning({message:"\u786E\u8BA4\u5BC6\u7801\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801",type:"warning"}),!1);return{stepForm:r,form:o,onCheckPhoneBlur:R,showCountDown:C,countDown:f,onValidSmsCodeClick:b,newPasswordType:d,newPasswordTypeChange:t,confirmPasswordType:u,confirmPasswordTypeChange:v,checkNewPassword:S,checkConfirmPassword:I,onResetPasswordCheck:()=>{if(!h()||!P())return;const y={phone:o.phone,validCode:o.validSmsCode};F(y).then(U=>{r.value=2})},onResetPassword:()=>{if(!S()||!I())return;const y={phone:o.phone,validCode:o.validSmsCode,newPassword:o.newPassword};q(y).then(U=>{e.push("/login")})},onUpdatePassword:()=>{e.push("/update_password")}}}}),L=e=>(A("data-v-03a3da92"),e=e(),H(),e),O={class:"passport-container"},Q={class:"passport-container-inner"},W={class:"passport-main"},X={class:"login-box"},Y=L(()=>m("div",{class:"login-box-tabs"},[m("h3",{class:"tab active"},"\u91CD\u7F6E\u5BC6\u7801")],-1)),Z={class:"login-box-form"},x={key:1,class:"valid-code count-down"},ee=_("\u4E0B\u4E00\u6B65"),se=_("\u4FEE\u6539\u5BC6\u7801"),oe=_("\u63D0\u4EA4"),ne=_("\u4FEE\u6539\u5BC6\u7801");function ae(e,r,o,C,f,R){const d=w("el-input"),t=w("el-form-item"),u=w("el-button"),v=w("el-link"),h=w("el-col"),P=w("el-form");return l(),V("div",O,[m("div",Q,[m("div",W,[m("div",X,[Y,m("div",Z,[e.stepForm===1?(l(),i(P,{key:0,class:"form reset",onKeydown:B(e.onResetPasswordCheck,["enter"])},{default:s(()=>[n(t,null,{default:s(()=>[n(d,{ref:"username",type:"text",modelValue:e.form.phone,"onUpdate:modelValue":r[0]||(r[0]=a=>e.form.phone=a),placeholder:"\u624B\u673A\u53F7",size:"large",maxlength:"50",onBlur:e.onCheckPhoneBlur},{prepend:s(()=>[(l(),i(c(e.useRenderIcon("phone","svg"))))]),_:1},8,["modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(d,{ref:"validCode",type:"text",modelValue:e.form.validSmsCode,"onUpdate:modelValue":r[2]||(r[2]=a=>e.form.validSmsCode=a),placeholder:"6\u4F4D\u6570\u5B57\u9A8C\u8BC1\u7801",size:"large",maxlength:"50"},{prepend:s(()=>[(l(),i(c(e.useRenderIcon("message","svg"))))]),append:s(()=>[e.showCountDown?k("",!0):(l(),V("span",{key:0,class:"valid-code send",onClick:r[1]||(r[1]=(...a)=>e.onValidSmsCodeClick&&e.onValidSmsCodeClick(...a))},"\u53D1\u9001\u9A8C\u8BC1\u7801")),e.showCountDown?(l(),V("span",x,z(e.countDown)+"s\u540E\u91CD\u65B0\u83B7\u53D6",1)):k("",!0)]),_:1},8,["modelValue"])]),_:1}),n(t,null,{default:s(()=>[n(u,{type:"primary",loading:e.form.loading,onClick:e.onResetPasswordCheck,style:{width:"100%"}},{default:s(()=>[ee]),_:1},8,["loading","onClick"]),n(h,{class:"link"},{default:s(()=>[n(v,{class:"link-text",underline:!1,onClick:e.onUpdatePassword},{default:s(()=>[se]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onKeydown"])):k("",!0),e.stepForm===2?(l(),i(P,{key:1,class:"form password",onKeydown:B(e.onResetPassword,["enter"])},{default:s(()=>[n(t,null,{default:s(()=>[n(d,{ref:"password",type:e.newPasswordType,modelValue:e.form.newPassword,"onUpdate:modelValue":r[3]||(r[3]=a=>e.form.newPassword=a),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",size:"large",maxlength:"50",onBlur:e.checkNewPassword},{prepend:s(()=>[(l(),i(c(e.useRenderIcon("lock","svg"))))]),append:s(()=>[(l(),i(c(e.useRenderIcon(e.newPasswordType?"eye-close":"eye-open","svg")),{onClick:e.newPasswordTypeChange},null,8,["onClick"]))]),_:1},8,["type","modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(d,{ref:"password",type:e.confirmPasswordType,modelValue:e.form.confirmPassword,"onUpdate:modelValue":r[4]||(r[4]=a=>e.form.confirmPassword=a),placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801",size:"large",maxlength:"50",onBlur:e.checkConfirmPassword},{prepend:s(()=>[(l(),i(c(e.useRenderIcon("lock","svg"))))]),append:s(()=>[(l(),i(c(e.useRenderIcon(e.confirmPasswordType?"eye-close":"eye-open","svg")),{onClick:e.confirmPasswordTypeChange},null,8,["onClick"]))]),_:1},8,["type","modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(u,{type:"primary",loading:e.form.loading,onClick:e.onResetPassword,style:{width:"100%"}},{default:s(()=>[oe]),_:1},8,["loading","onClick"]),n(h,{class:"link"},{default:s(()=>[n(v,{class:"link-text",underline:!1,onClick:e.onUpdatePassword},{default:s(()=>[ne]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onKeydown"])):k("",!0)])])])])])}var ue=D(G,[["render",ae],["__scopeId","data-v-03a3da92"]]);export{ue as default};

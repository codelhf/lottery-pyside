import{D as h,K as O,h as s,r as m,o as P,p as G,w as n,b as l,a as z,t as M,e as f,N as j,E as K}from"./index.d764b3ff.js";import{T as R,a as x}from"./layout.4cd61cc3.js";function $(o){return h({url:"/channel",method:"GET",params:o})}function q(o){return h({url:"/channel/"+o,method:"GET"})}function Q(o){return h({url:"/channel/check/exists",method:"GET",params:o})}function A(o){return h({url:"/channel",method:"POST",data:o})}function H(o){return h({url:"/channel/"+o.idcntvChannel,method:"POST",data:o})}function N(o){return h({url:"/channel/delete/"+o,method:"POST"})}const J=f("\u67E5\u8BE2"),W=f("\u91CD\u7F6E"),X=f("\u65B0\u589E\u9891\u9053\u7BA1\u7406"),Y=f("\u6279\u91CF\u5220\u9664"),Z={class:"dialog-footer"},ee=f("\u53D6\u6D88"),ne=f("\u786E\u5B9A"),le={name:"Channel",components:{TableList:R,TableLayout:x}},oe=Object.assign(le,{setup(o){O(()=>{r()});const i=s({pageNum:1,pageSize:10,sort:"",channelname:""});function B(){i.value.pageNum=1,r()}function L(){i.value={pageNum:1,pageSize:10,sort:"",channelname:""}}const b=s(null),p=s(!1),y=s([]),v=s(0);function r(){p.value=!0,$(i.value).then(e=>{y.value=e.data.list,v.value=e.data.total,setTimeout(()=>{p.value=!1},1.5*1e3)})}function k(e){j.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u5220\u9664\u63D0\u793A",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",type:"warning"}).then(()=>{if(e&&e.idcntvChannel)N(e.idcntvChannel).then(a=>{r()});else{const a=b.value.getSelectedRowKeys();N(a.join(",")).then(g=>{r()})}})}const d=s(!1),u=s({idcntvChannel:"",channelname:""}),E=s({channelname:[{required:!0,message:"\u9891\u9053\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});function T(e){u.value={},d.value=!0,e&&e.idcntvChannel&&q(e.idcntvChannel).then(a=>{u.value=a.data})}function F(){u.value.channelname&&Q(u.value).then(e=>{e.data&&K.error("\u9891\u9053\u5DF2\u5B58\u5728")})}const _=s(null);function V(){_.value.resetFields(),d.value=!1,u.value={}}function I(){_.value.validate(e=>{e&&(u.value.idcntvChannel?H(u.value).then(a=>{d.value=!1,r()}):A(u.value).then(a=>{d.value=!1,r()}))})}return(e,a)=>{const g=m("el-input"),C=m("el-form-item"),c=m("el-button"),w=m("el-form"),S=m("el-table-column"),D=m("el-dialog");return P(),G(x,{title:"\u9891\u9053\u7BA1\u7406\u5217\u8868"},{form:n(()=>[l(w,{model:i.value,inline:!0,"label-width":"120px","label-suffix":":"},{default:n(()=>[l(C,{label:"\u9891\u9053\u540D\u79F0"},{default:n(()=>[l(g,{modelValue:i.value.channelname,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value.channelname=t),placeholder:"\u8BF7\u8F93\u5165\u9891\u9053\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(C,null,{default:n(()=>[l(c,{type:"primary",icon:e.useRenderIcon("search"),onClick:B},{default:n(()=>[J]),_:1},8,["icon"]),l(c,{type:"primary",icon:e.useRenderIcon("refresh-left"),onClick:L},{default:n(()=>[W]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),button:n(()=>[l(c,{type:"primary",icon:e.useRenderIcon("plus"),onClick:T},{default:n(()=>[X]),_:1},8,["icon"]),l(c,{type:"warning",icon:e.useRenderIcon("delete"),onClick:k},{default:n(()=>[Y]),_:1},8,["icon"])]),table:n(()=>[l(R,{ref_key:"tableListDom",ref:b,data:y.value,loading:p.value,"show-selection":!0,"show-page":v.value>0,"page-total":v.value,"page-num":i.value.pageNum,"onUpdate:page-num":a[1]||(a[1]=t=>i.value.pageNum=t),"page-size":i.value.pageSize,"onUpdate:page-size":a[2]||(a[2]=t=>i.value.pageSize=t),onPagination:r},{default:n(()=>[l(S,{label:"\u9891\u9053\u540D\u79F0",align:"center"},{default:n(t=>[z("span",null,M(t.row.channelname),1)]),_:1}),l(S,{label:"\u64CD\u4F5C",align:"center",width:"160",fixed:"right"},{default:n(t=>[l(c,{type:"primary",size:"small",circle:"",icon:e.useRenderIcon("edit"),onClick:U=>T(t.row),title:"\u7F16\u8F91"},null,8,["icon","onClick"]),l(c,{type:"warning",size:"small",circle:"",icon:e.useRenderIcon("delete"),onClick:U=>k(t.row),title:"\u5220\u9664"},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","loading","show-page","page-total","page-num","page-size"]),l(D,{title:u.value.idcntvChannel?"\u4FEE\u6539\u9891\u9053":"\u65B0\u589E\u9891\u9053",modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=t=>d.value=t),onClose:V},{footer:n(()=>[z("span",Z,[l(c,{onClick:V},{default:n(()=>[ee]),_:1}),l(c,{type:"primary",onClick:I},{default:n(()=>[ne]),_:1})])]),default:n(()=>[l(w,{ref_key:"dialogForm",ref:_,model:u.value,rules:E.value,"label-width":"120px","label-suffix":":"},{default:n(()=>[l(C,{label:"\u9891\u9053\u540D\u79F0",prop:"channelname"},{default:n(()=>[l(g,{modelValue:u.value.channelname,"onUpdate:modelValue":a[3]||(a[3]=t=>u.value.channelname=t),placeholder:"\u8BF7\u8F93\u5165\u9891\u9053\u540D\u79F0",onBlur:F},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])]),_:1})}}});export{oe as default};

import{D as b,k as J,K as W,h as s,r as d,o as I,p as F,w as n,b as a,c as X,T as Y,Q as Z,a as _,t as h,e as p,L as x}from"./index.b044c83d.js";import{f as ee,T as B,U as D,a as $}from"./index.8b31b00f.js";function le(u){return b({url:"/user/list",method:"get",params:u})}function ae(u){return b({url:"/user/"+u,method:"get",params:{id:u}})}function te(u){return b({url:"/user",method:"post",data:u})}function ne(u){return b({url:"/user/"+u.id,method:"put",data:u})}function S(u){return b({url:"/user/"+u,method:"delete",params:{ids:u}})}const oe=p("\u641C\u7D22"),ue=p("\u91CD\u7F6E"),re=p("\u65B0\u589E\u4EBA\u5458"),ie=p("\u6279\u91CF\u5220\u9664"),se=p("\u8868\u683C\u6A21\u677F"),de=p("\u4E0A\u4F20\u8868\u683C"),pe=p("\u4E0B\u8F7D\u8868\u683C"),me={class:"dialog-footer"},ce=p("\u53D6\u6D88"),fe=p("\u786E\u5B9A"),ve={name:"User",components:{TableList:B,TableLayout:$,UploadImage:D}},be=Object.assign(ve,{setup(u){const P=J();W(()=>{const{prizeId:t}=P.query;t&&(r.value.prizeId=t),m(),E()});const r=s({pageNum:1,pageSize:10,sort:"",username:"",prizeId:""});function q(){r.value.pageNum=1,m()}function j(){r.value={pageNum:1,pageSize:10,sort:"",username:"",prizeId:""}}const w=s(null),y=s(!1),C=s([]),z=s(0);function m(){y.value=!0,le(r.value).then(t=>{C.value=t.data.list,z.value=t.data.total,setTimeout(()=>{y.value=!1},1.5*1e3)})}const k=s([]);function E(){ee().then(t=>{k.value=t.data,k.value=k.value.sort((l,v)=>l.number-v.number)})}function U(t){x.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u5220\u9664\u63D0\u793A",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",type:"warning"}).then(()=>{if(t&&t.id)S(t.id).then(l=>{m()});else{const l=w.value.getSelectedRowKeys();S(l.join(",")).then(v=>{m()})}})}const f=s(!1),o=s({id:"",prizeId:"",avatar:"",username:"",description:"",operateTime:""}),K=s({username:[{required:!0,message:"\u4EBA\u5458\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{required:!0,message:"\u4EBA\u5458\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});function R(t){o.value={},f.value=!0,t&&t.id&&ae(t.id).then(l=>{l.data.avatar||(l.data.avatar=""),o.value=l.data})}function M(t){o.value.avatar=t}const V=s(null);function L(){V.value.resetFields(),f.value=!1,o.value={}}function Q(){V.value.validate(t=>{t&&(o.value.id?ne(o.value).then(l=>{f.value=!1,m()}):te(o.value).then(l=>{f.value=!1,m()}))})}return(t,l)=>{const v=d("el-input"),g=d("el-form-item"),O=d("el-option"),A=d("el-select"),i=d("el-button"),T=d("el-form"),N=d("table-image"),c=d("el-table-column"),G=d("el-dialog");return I(),F($,{title:"\u4EBA\u5458\u5217\u8868"},{form:n(()=>[a(T,{model:r.value,inline:!0,"label-width":"120px","label-suffix":":"},{default:n(()=>[a(g,{label:"\u4EBA\u5458\u540D\u79F0"},{default:n(()=>[a(v,{modelValue:r.value.username,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value.username=e),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u5458\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(g,{label:"\u5956\u54C1\u540D\u79F0"},{default:n(()=>[a(A,{modelValue:r.value.prizeId,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value.prizeId=e),placeholder:"\u8BF7\u8F93\u5165\u5956\u54C1\u540D\u79F0"},{default:n(()=>[(I(!0),X(Z,null,Y(t.allPrize,e=>(I(),F(O,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,null,{default:n(()=>[a(i,{type:"primary",icon:t.useRenderIcon("search"),onClick:q},{default:n(()=>[oe]),_:1},8,["icon"]),a(i,{type:"primary",icon:t.useRenderIcon("refresh-left"),onClick:j},{default:n(()=>[ue]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),button:n(()=>[a(i,{type:"primary",icon:t.useRenderIcon("plus"),onClick:l[2]||(l[2]=e=>R())},{default:n(()=>[re]),_:1},8,["icon"]),a(i,{type:"warning",icon:t.useRenderIcon("delete"),onClick:l[3]||(l[3]=e=>U())},{default:n(()=>[ie]),_:1},8,["icon"]),a(i,{type:"primary",icon:t.useRenderIcon("document"),onClick:l[4]||(l[4]=e=>t.handleDocument())},{default:n(()=>[se]),_:1},8,["icon"]),a(i,{type:"primary",icon:t.useRenderIcon("upload2"),onClick:l[5]||(l[5]=e=>t.handleUpload())},{default:n(()=>[de]),_:1},8,["icon"]),a(i,{type:"primary",icon:t.useRenderIcon("download"),onClick:l[6]||(l[6]=e=>t.handleDownload())},{default:n(()=>[pe]),_:1},8,["icon"])]),table:n(()=>[a(B,{ref_key:"tableListDom",ref:w,data:C.value,loading:y.value,"show-selection":!0,"show-page":z.value>0,"page-total":z.value,"page-num":r.value.pageNum,"onUpdate:page-num":l[7]||(l[7]=e=>r.value.pageNum=e),"page-size":r.value.pageSize,"onUpdate:page-size":l[8]||(l[8]=e=>r.value.pageSize=e),onPagination:m},{default:n(()=>[a(c,{label:"\u5934\u50CF",align:"center"},{default:n(e=>[a(N,{src:e.row.avatar},null,8,["src"])]),_:1}),a(c,{label:"\u4EBA\u5458\u540D\u79F0",align:"center"},{default:n(e=>[_("span",null,h(e.row.username),1)]),_:1}),a(c,{label:"\u4EBA\u5458\u63CF\u8FF0",align:"center"},{default:n(e=>[_("span",null,h(e.row.desc),1)]),_:1}),a(c,{label:"\u5956\u54C1\u56FE\u7247",align:"center"},{default:n(e=>[a(N,{src:e.row.prizeImage},null,8,["src"])]),_:1}),a(c,{label:"\u5956\u54C1\u540D\u79F0",align:"center"},{default:n(e=>[_("span",null,h(e.row.prizeName),1)]),_:1}),a(c,{label:"\u64CD\u4F5C\u65F6\u95F4",align:"center"},{default:n(e=>[_("span",null,h(e.row.operateTime),1)]),_:1}),a(c,{label:"\u64CD\u4F5C",align:"center",width:"160"},{default:n(e=>[a(i,{type:"primary",size:"small",circle:"",icon:t.useRenderIcon("edit"),onClick:H=>R(e.row),title:"\u7F16\u8F91"},null,8,["icon","onClick"]),a(i,{type:"danger",size:"small",circle:"",icon:t.useRenderIcon("delete"),onClick:H=>U(e.row),title:"\u5220\u9664"},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","loading","show-page","page-total","page-num","page-size"]),a(G,{title:o.value.id?"\u4FEE\u6539\u4EBA\u5458":"\u65B0\u589E\u4EBA\u5458",modelValue:f.value,"onUpdate:modelValue":l[11]||(l[11]=e=>f.value=e),onClose:L},{footer:n(()=>[_("span",me,[a(i,{onClick:L},{default:n(()=>[ce]),_:1}),a(i,{type:"primary",onClick:Q},{default:n(()=>[fe]),_:1})])]),default:n(()=>[a(T,{ref_key:"dialogForm",ref:V,model:o.value,rules:K.value,"label-width":"120px","label-suffix":":"},{default:n(()=>[a(g,{label:"\u4EBA\u5458\u5934\u50CF",prop:"avatar"},{default:n(()=>[a(D,{"image-url":o.value.avatar,onUploadPath:M},null,8,["image-url"])]),_:1}),a(g,{label:"\u4EBA\u5458\u540D\u79F0",prop:"username"},{default:n(()=>[a(v,{modelValue:o.value.username,"onUpdate:modelValue":l[9]||(l[9]=e=>o.value.username=e),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u5458\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(g,{label:"\u4EBA\u5458\u63CF\u8FF0",prop:"description"},{default:n(()=>[a(v,{modelValue:o.value.description,"onUpdate:modelValue":l[10]||(l[10]=e=>o.value.description=e),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u5458\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])]),_:1})}}});export{be as default};

import{_ as U,d as K,u as N,h as g,p as z,o as l,c as V,a as m,y as i,w as s,b as n,A as w,z as k,v as $,B as I,J as F,E as p,K as E,L as A,e as _,r as c,D as J,F as L}from"./index.da671b22.js";import{i as b,a as M,b as j}from"./index.c998d848.js";import{s as q}from"./valid-code.266ba7b8.js";const G=K({name:"ResetPassword",setup(){const e=N(),r=g(1),o=z({loading:!1,phone:"",validSmsCode:"",newPassword:"",confirmPassword:""}),v=g(!1),f=g(300),R=()=>{F({phone:o.phone})},d=g("password"),t=()=>{d.value===""?d.value="password":d.value=""},u=g("password"),C=()=>{u.value===""?u.value="password":u.value=""},h=()=>o.phone?M(o.phone)?!0:(p.warning({message:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u5148\u8F93\u5165\u624B\u673A\u53F7",type:"warning"}),!1),P=()=>!o.validSmsCode||!j(o.validSmsCode)?(p.warning({message:"\u8BF7\u8F93\u51656\u4F4D\u6570\u5B57\u9A8C\u8BC1\u7801",type:"warning"}),!1):!0;let a=null;const T=()=>{if(!h()){console.log("1");return}console.log("2"),q(o).then(y=>{v.value=!0,a&&clearInterval(a),a=setInterval(()=>{f.value=f.value-1,f.value===0&&(v.value=!1,clearInterval(a))},1e3)})},S=()=>o.newPassword?b(o.newPassword)?!0:(p.warning({message:"\u65B0\u5BC6\u7801\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",type:"warning"}),!1),B=()=>o.confirmPassword?b(o.confirmPassword)?o.confirmPassword!==o.newPassword?(p.warning({message:"\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4",type:"warning"}),!1):!0:(p.warning({message:"\u786E\u8BA4\u5BC6\u7801\u683C\u5F0F\u4E0D\u6B63\u786E",type:"warning"}),!1):(p.warning({message:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801",type:"warning"}),!1);return{stepForm:r,form:o,onCheckPhoneBlur:R,showCountDown:v,countDown:f,onValidSmsCodeClick:T,newPasswordType:d,newPasswordTypeChange:t,confirmPasswordType:u,confirmPasswordTypeChange:C,checkNewPassword:S,checkConfirmPassword:B,onResetPasswordCheck:()=>{if(!h()||!P())return;const y={phone:o.phone,validCode:o.validSmsCode};E(y).then(D=>{r.value=2})},onResetPassword:()=>{if(!S()||!B())return;const y={phone:o.phone,validCode:o.validSmsCode,newPassword:o.newPassword};A(y).then(D=>{e.push("/login")})},onUpdatePassword:()=>{e.push("/update_password")}}}}),H=e=>(J("data-v-7d76b8ca"),e=e(),L(),e),O={class:"passport-container"},Q={class:"passport-container-inner"},W={class:"passport-main"},X={class:"login-box"},Y=H(()=>m("div",{class:"login-box-tabs"},[m("h3",{class:"tab active"},"\u91CD\u7F6E\u5BC6\u7801")],-1)),Z={class:"login-box-form"},x={key:1,class:"valid-code count-down"},ee=_("\u4E0B\u4E00\u6B65"),se=_("\u4FEE\u6539\u5BC6\u7801"),oe=_("\u63D0\u4EA4"),ne=_("\u4FEE\u6539\u5BC6\u7801");function ae(e,r,o,v,f,R){const d=c("el-input"),t=c("el-form-item"),u=c("el-button"),C=c("el-link"),h=c("el-col"),P=c("el-form");return l(),V("div",O,[m("div",Q,[m("div",W,[m("div",X,[Y,m("div",Z,[e.stepForm===1?(l(),i(P,{key:0,class:"form reset",onKeydown:I(e.onResetPasswordCheck,["enter"])},{default:s(()=>[n(t,null,{default:s(()=>[n(d,{ref:"username",type:"text",modelValue:e.form.phone,"onUpdate:modelValue":r[0]||(r[0]=a=>e.form.phone=a),placeholder:"\u624B\u673A\u53F7",size:"large",maxlength:"50",onBlur:e.onCheckPhoneBlur},{prepend:s(()=>[(l(),i(w(e.useRenderIcon("phone","svg"))))]),_:1},8,["modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(d,{ref:"validCode",type:"text",modelValue:e.form.validSmsCode,"onUpdate:modelValue":r[2]||(r[2]=a=>e.form.validSmsCode=a),placeholder:"6\u4F4D\u6570\u5B57\u9A8C\u8BC1\u7801",size:"large",maxlength:"50"},{prepend:s(()=>[(l(),i(w(e.useRenderIcon("message","svg"))))]),append:s(()=>[e.showCountDown?k("",!0):(l(),V("span",{key:0,class:"valid-code send",onClick:r[1]||(r[1]=(...a)=>e.onValidSmsCodeClick&&e.onValidSmsCodeClick(...a))},"\u53D1\u9001\u9A8C\u8BC1\u7801")),e.showCountDown?(l(),V("span",x,$(e.countDown)+"s\u540E\u91CD\u65B0\u83B7\u53D6",1)):k("",!0)]),_:1},8,["modelValue"])]),_:1}),n(t,null,{default:s(()=>[n(u,{type:"primary",loading:e.form.loading,onClick:e.onResetPasswordCheck,style:{width:"100%"}},{default:s(()=>[ee]),_:1},8,["loading","onClick"]),n(h,{class:"link"},{default:s(()=>[n(C,{class:"link-text",underline:!1,onClick:e.onUpdatePassword},{default:s(()=>[se]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onKeydown"])):k("",!0),e.stepForm===2?(l(),i(P,{key:1,class:"form password",onKeydown:I(e.onResetPassword,["enter"])},{default:s(()=>[n(t,null,{default:s(()=>[n(d,{ref:"password",type:e.newPasswordType,modelValue:e.form.newPassword,"onUpdate:modelValue":r[3]||(r[3]=a=>e.form.newPassword=a),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",size:"large",maxlength:"50",onBlur:e.checkNewPassword},{prepend:s(()=>[(l(),i(w(e.useRenderIcon("lock","svg"))))]),append:s(()=>[(l(),i(w(e.useRenderIcon(e.newPasswordType?"eye-close":"eye-open","svg")),{onClick:e.newPasswordTypeChange},null,8,["onClick"]))]),_:1},8,["type","modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(d,{ref:"password",type:e.confirmPasswordType,modelValue:e.form.confirmPassword,"onUpdate:modelValue":r[4]||(r[4]=a=>e.form.confirmPassword=a),placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801",size:"large",maxlength:"50",onBlur:e.checkConfirmPassword},{prepend:s(()=>[(l(),i(w(e.useRenderIcon("lock","svg"))))]),append:s(()=>[(l(),i(w(e.useRenderIcon(e.confirmPasswordType?"eye-close":"eye-open","svg")),{onClick:e.confirmPasswordTypeChange},null,8,["onClick"]))]),_:1},8,["type","modelValue","onBlur"])]),_:1}),n(t,null,{default:s(()=>[n(u,{type:"primary",loading:e.form.loading,onClick:e.onResetPassword,style:{width:"100%"}},{default:s(()=>[oe]),_:1},8,["loading","onClick"]),n(h,{class:"link"},{default:s(()=>[n(C,{class:"link-text",underline:!1,onClick:e.onUpdatePassword},{default:s(()=>[ne]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onKeydown"])):k("",!0)])])])])])}var ue=U(G,[["render",ae],["__scopeId","data-v-7d76b8ca"]]);export{ue as default};
